(async()=>{var e=""+new URL("wasmlabs_bg-fa6b70e6.wasm",import.meta.url).href;let n;const t=new Array(128).fill(void 0);function a(e){return t[e]}t.push(void 0,null,!0,!1);let _=t.length;function r(e){const n=a(e);return function(e){e<132||(t[e]=_,_=e)}(e),n}let o=new("undefined"==typeof TextDecoder?(0,module.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});o.decode();let i=null;function c(){return null!==i&&0!==i.byteLength||(i=new Uint8Array(n.memory.buffer)),i}function d(e,n){return o.decode(c().subarray(e,e+n))}function s(e){_===t.length&&t.push(t.length+1);const n=_;return _=t[n],t[n]=e,n}let l=0;let b=new("undefined"==typeof TextEncoder?(0,module.require)("util").TextEncoder:TextEncoder)("utf-8");const f="function"==typeof b.encodeInto?function(e,n){return b.encodeInto(e,n)}:function(e,n){const t=b.encode(e);return n.set(t),{read:e.length,written:t.length}};function u(e,n,t){if(void 0===t){const t=b.encode(e),a=n(t.length);return c().subarray(a,a+t.length).set(t),l=t.length,a}let a=e.length,_=n(a);const r=c();let o=0;for(;o<a;o++){const n=e.charCodeAt(o);if(n>127)break;r[_+o]=n}if(o!==a){0!==o&&(e=e.slice(o)),_=t(_,a,a=o+3*e.length);const n=c().subarray(_+o,_+a);o+=f(e,n).written}return l=o,_}let g=null;function w(){return null!==g&&0!==g.byteLength||(g=new Int32Array(n.memory.buffer)),g}function y(e,t){try{const r=n.__wbindgen_add_to_stack_pointer(-16),o=u(e,n.__wbindgen_malloc,n.__wbindgen_realloc),i=l,c=u(t,n.__wbindgen_malloc,n.__wbindgen_realloc),s=l;n.getaccesskeyfrompassword(r,o,i,c,s);var a=w()[r/4+0],_=w()[r/4+1];return d(a,_)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(a,_)}}function m(e,t){try{const r=n.__wbindgen_add_to_stack_pointer(-16),o=u(e,n.__wbindgen_malloc,n.__wbindgen_realloc),i=l,c=u(t,n.__wbindgen_malloc,n.__wbindgen_realloc),s=l;n.getadditionalmetadata(r,o,i,c,s);var a=w()[r/4+0],_=w()[r/4+1];return d(a,_)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(a,_)}}function p(e,t,a){try{const o=n.__wbindgen_add_to_stack_pointer(-16),i=u(e,n.__wbindgen_malloc,n.__wbindgen_realloc),c=l,s=u(t,n.__wbindgen_malloc,n.__wbindgen_realloc),b=l,f=u(a,n.__wbindgen_malloc,n.__wbindgen_realloc),g=l;n.setadditionalmetadata(o,i,c,s,b,f,g);var _=w()[o/4+0],r=w()[o/4+1];return d(_,r)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(_,r)}}function h(e){try{const _=n.__wbindgen_add_to_stack_pointer(-16),r=u(e,n.__wbindgen_malloc,n.__wbindgen_realloc),o=l;n.newdatabase(_,r,o);var t=w()[_/4+0],a=w()[_/4+1];return d(t,a)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(t,a)}}function k(e,t){try{return e.apply(this,t)}catch(a){n.__wbindgen_exn_store(s(a))}}URL=globalThis.URL;const A=await (async(e={},n)=>{let t;if(n.startsWith("data:")){const a=n.replace(/^data:.*?base64,/,"");let _;if("function"==typeof Buffer&&"function"==typeof Buffer.from)_=Buffer.from(a,"base64");else{if("function"!=typeof atob)throw new Error("Cannot decode base64-encoded data URL");{const e=atob(a);_=new Uint8Array(e.length);for(let n=0;n<e.length;n++)_[n]=e.charCodeAt(n)}}t=await WebAssembly.instantiate(_,e)}else{const a=await fetch(n),_=a.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&_.startsWith("application/wasm"))t=await WebAssembly.instantiateStreaming(a,e);else{const n=await a.arrayBuffer();t=await WebAssembly.instantiate(n,e)}}return t.instance.exports})({"./wasmlabs_bg.js":{__wbg_new_abda76e883ba8a5f:function(){return s(new Error)},__wbg_stack_658279fe44541cf6:function(e,t){const _=u(a(t).stack,n.__wbindgen_malloc,n.__wbindgen_realloc),r=l;w()[e/4+1]=r,w()[e/4+0]=_},__wbg_error_f851667af71bcfc6:function(e,t){try{console.error(d(e,t))}finally{n.__wbindgen_free(e,t)}},__wbindgen_object_drop_ref:function(e){r(e)},__wbg_randomFillSync_dc1e9a60c158336d:function(){return k((function(e,n){a(e).randomFillSync(r(n))}),arguments)},__wbg_getRandomValues_37fa2ca9e4e07fab:function(){return k((function(e,n){a(e).getRandomValues(a(n))}),arguments)},__wbg_crypto_c48a774b022d20ac:function(e){return s(a(e).crypto)},__wbindgen_is_object:function(e){const n=a(e);return"object"==typeof n&&null!==n},__wbg_process_298734cf255a885d:function(e){return s(a(e).process)},__wbg_versions_e2e78e134e3e5d01:function(e){return s(a(e).versions)},__wbg_node_1cd7a5d853dbea79:function(e){return s(a(e).node)},__wbindgen_is_string:function(e){return"string"==typeof a(e)},__wbg_require_8f08ceecec0f4fee:function(){return k((function(){return s(module.require)}),arguments)},__wbindgen_string_new:function(e,n){return s(d(e,n))},__wbg_msCrypto_bcb970640f50a1e8:function(e){return s(a(e).msCrypto)},__wbindgen_is_function:function(e){return"function"==typeof a(e)},__wbg_newnoargs_2b8b6bd7753c76ba:function(e,n){return s(new Function(d(e,n)))},__wbg_call_95d1ea488d03e4e8:function(){return k((function(e,n){return s(a(e).call(a(n)))}),arguments)},__wbg_self_e7c1f827057f6584:function(){return k((function(){return s(self.self)}),arguments)},__wbg_window_a09ec664e14b1b81:function(){return k((function(){return s(window.window)}),arguments)},__wbg_globalThis_87cbb8506fecf3a9:function(){return k((function(){return s(globalThis.globalThis)}),arguments)},__wbg_global_c85a9259e621f3db:function(){return k((function(){return s(global.global)}),arguments)},__wbindgen_is_undefined:function(e){return void 0===a(e)},__wbg_call_9495de66fdbe016b:function(){return k((function(e,n,t){return s(a(e).call(a(n),a(t)))}),arguments)},__wbg_getTime_7c59072d1651a3cf:function(e){return a(e).getTime()},__wbg_new0_25059e40b1c02766:function(){return s(new Date)},__wbg_buffer_cf65c07de34b9a08:function(e){return s(a(e).buffer)},__wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5:function(e,n,t){return s(new Uint8Array(a(e),n>>>0,t>>>0))},__wbg_new_537b7341ce90bb31:function(e){return s(new Uint8Array(a(e)))},__wbg_set_17499e8aa4003ebd:function(e,n,t){a(e).set(a(n),t>>>0)},__wbg_newwithlength_b56c882b57805732:function(e){return s(new Uint8Array(e>>>0))},__wbg_subarray_7526649b91a252a6:function(e,n,t){return s(a(e).subarray(n>>>0,t>>>0))},__wbindgen_object_clone_ref:function(e){return s(a(e))},__wbindgen_throw:function(e,n){throw new Error(d(e,n))},__wbindgen_memory:function(){return s(n.memory)}}},e),T=A.memory,v=A.getaccesskeyfrompassword,x=A.getadditionalmetadata,M=A.setadditionalmetadata,U=A.newdatabase,D=A.__wbindgen_add_to_stack_pointer,O=A.__wbindgen_malloc,S=A.__wbindgen_realloc,j=A.__wbindgen_free,C=A.__wbindgen_exn_store;n=Object.freeze({__proto__:null,__wbindgen_add_to_stack_pointer:D,__wbindgen_exn_store:C,__wbindgen_free:j,__wbindgen_malloc:O,__wbindgen_realloc:S,getaccesskeyfrompassword:v,getadditionalmetadata:x,memory:T,newdatabase:U,setadditionalmetadata:M}),postMessage("ready"),onmessage=e=>{switch(e.data.req){case"newdatabase":console.log("Starting database generation at: "+Date());let t=Date.now();try{postMessage({rtype:"newdatabase",data:JSON.parse(h(e.data.password))})}catch(n){postMessage({fail:!0,rtype:"newdatabase",data:n})}console.log("Finished at: "+Date()+" , total time: "+(Date.now()-t)/1e3+" seconds");break;case"getaccesskey":console.log("Opening database...");try{postMessage({rtype:"getaccesskey",data:y(e.data.database,e.data.password)})}catch(n){postMessage({fail:!0,rtype:"getaccesskey",data:n})}break;case"getadditionalmetadata":console.log("Opening database...");try{postMessage({rtype:"getadditionalmetadata",data:JSON.parse(m(e.data.database,e.data.password))})}catch(n){postMessage({fail:!0,rtype:"getadditionalmetadata",data:n})}break;case"setadditionalmetadata":console.log("Opening database...");try{postMessage({rtype:"setadditionalmetadata",data:p(e.data.database,e.data.password,e.data.metadata)})}catch(n){postMessage({rtype:"setadditionalmetadata",data:n,fail:!0})}}}})();