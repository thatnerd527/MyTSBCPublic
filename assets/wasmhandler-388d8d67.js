(function(){"use strict";(async()=>{var x=""+new URL("wasmlabs_bg-fa6b70e6.wasm",document.currentScript&&document.currentScript.src||new URL("assets/wasmhandler-388d8d67.js",document.baseURI).href).href;let a;const f=new Array(128).fill(void 0);function _(e){return f[e]}f.push(void 0,null,!0,!1);let p=f.length;function v(e){const n=_(e);return function(t){t<132||(f[t]=p,p=t)}(e),n}let U=new(typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});U.decode();let h=null;function k(){return h!==null&&h.byteLength!==0||(h=new Uint8Array(a.memory.buffer)),h}function y(e,n){return U.decode(k().subarray(e,e+n))}function i(e){p===f.length&&f.push(f.length+1);const n=p;return p=f[n],f[n]=e,n}let l=0,A=new(typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder)("utf-8");const M=typeof A.encodeInto=="function"?function(e,n){return A.encodeInto(e,n)}:function(e,n){const t=A.encode(e);return n.set(t),{read:e.length,written:t.length}};function g(e,n,t){if(t===void 0){const s=A.encode(e),m=n(s.length);return k().subarray(m,m+s.length).set(s),l=s.length,m}let r=e.length,o=n(r);const d=k();let c=0;for(;c<r;c++){const s=e.charCodeAt(c);if(s>127)break;d[o+c]=s}if(c!==r){c!==0&&(e=e.slice(c)),o=t(o,r,r=c+3*e.length);const s=k().subarray(o+c,o+r);c+=M(e,s).written}return l=c,o}let T=null;function u(){return T!==null&&T.byteLength!==0||(T=new Int32Array(a.memory.buffer)),T}function S(e,n){try{const o=a.__wbindgen_add_to_stack_pointer(-16),d=g(e,a.__wbindgen_malloc,a.__wbindgen_realloc),c=l,s=g(n,a.__wbindgen_malloc,a.__wbindgen_realloc),m=l;a.getaccesskeyfrompassword(o,d,c,s,m);var t=u()[o/4+0],r=u()[o/4+1];return y(t,r)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(t,r)}}function D(e,n){try{const o=a.__wbindgen_add_to_stack_pointer(-16),d=g(e,a.__wbindgen_malloc,a.__wbindgen_realloc),c=l,s=g(n,a.__wbindgen_malloc,a.__wbindgen_realloc),m=l;a.getadditionalmetadata(o,d,c,s,m);var t=u()[o/4+0],r=u()[o/4+1];return y(t,r)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(t,r)}}function j(e,n,t){try{const d=a.__wbindgen_add_to_stack_pointer(-16),c=g(e,a.__wbindgen_malloc,a.__wbindgen_realloc),s=l,m=g(n,a.__wbindgen_malloc,a.__wbindgen_realloc),N=l,V=g(t,a.__wbindgen_malloc,a.__wbindgen_realloc),z=l;a.setadditionalmetadata(d,c,s,m,N,V,z);var r=u()[d/4+0],o=u()[d/4+1];return y(r,o)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(r,o)}}function O(e){try{const r=a.__wbindgen_add_to_stack_pointer(-16),o=g(e,a.__wbindgen_malloc,a.__wbindgen_realloc),d=l;a.newdatabase(r,o,d);var n=u()[r/4+0],t=u()[r/4+1];return y(n,t)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(n,t)}}function w(e,n){try{return e.apply(this,n)}catch(t){a.__wbindgen_exn_store(i(t))}}URL=globalThis.URL;const b=await(async(e={},n)=>{let t;if(n.startsWith("data:")){const r=n.replace(/^data:.*?base64,/,"");let o;if(typeof Buffer=="function"&&typeof Buffer.from=="function")o=Buffer.from(r,"base64");else{if(typeof atob!="function")throw new Error("Cannot decode base64-encoded data URL");{const d=atob(r);o=new Uint8Array(d.length);for(let c=0;c<d.length;c++)o[c]=d.charCodeAt(c)}}t=await WebAssembly.instantiate(o,e)}else{const r=await fetch(n),o=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&o.startsWith("application/wasm"))t=await WebAssembly.instantiateStreaming(r,e);else{const d=await r.arrayBuffer();t=await WebAssembly.instantiate(d,e)}}return t.instance.exports})({"./wasmlabs_bg.js":{__wbg_new_abda76e883ba8a5f:function(){return i(new Error)},__wbg_stack_658279fe44541cf6:function(e,n){const t=g(_(n).stack,a.__wbindgen_malloc,a.__wbindgen_realloc),r=l;u()[e/4+1]=r,u()[e/4+0]=t},__wbg_error_f851667af71bcfc6:function(e,n){try{console.error(y(e,n))}finally{a.__wbindgen_free(e,n)}},__wbindgen_object_drop_ref:function(e){v(e)},__wbg_randomFillSync_dc1e9a60c158336d:function(){return w(function(e,n){_(e).randomFillSync(v(n))},arguments)},__wbg_getRandomValues_37fa2ca9e4e07fab:function(){return w(function(e,n){_(e).getRandomValues(_(n))},arguments)},__wbg_crypto_c48a774b022d20ac:function(e){return i(_(e).crypto)},__wbindgen_is_object:function(e){const n=_(e);return typeof n=="object"&&n!==null},__wbg_process_298734cf255a885d:function(e){return i(_(e).process)},__wbg_versions_e2e78e134e3e5d01:function(e){return i(_(e).versions)},__wbg_node_1cd7a5d853dbea79:function(e){return i(_(e).node)},__wbindgen_is_string:function(e){return typeof _(e)=="string"},__wbg_require_8f08ceecec0f4fee:function(){return w(function(){return i(module.require)},arguments)},__wbindgen_string_new:function(e,n){return i(y(e,n))},__wbg_msCrypto_bcb970640f50a1e8:function(e){return i(_(e).msCrypto)},__wbindgen_is_function:function(e){return typeof _(e)=="function"},__wbg_newnoargs_2b8b6bd7753c76ba:function(e,n){return i(new Function(y(e,n)))},__wbg_call_95d1ea488d03e4e8:function(){return w(function(e,n){return i(_(e).call(_(n)))},arguments)},__wbg_self_e7c1f827057f6584:function(){return w(function(){return i(self.self)},arguments)},__wbg_window_a09ec664e14b1b81:function(){return w(function(){return i(window.window)},arguments)},__wbg_globalThis_87cbb8506fecf3a9:function(){return w(function(){return i(globalThis.globalThis)},arguments)},__wbg_global_c85a9259e621f3db:function(){return w(function(){return i(global.global)},arguments)},__wbindgen_is_undefined:function(e){return _(e)===void 0},__wbg_call_9495de66fdbe016b:function(){return w(function(e,n,t){return i(_(e).call(_(n),_(t)))},arguments)},__wbg_getTime_7c59072d1651a3cf:function(e){return _(e).getTime()},__wbg_new0_25059e40b1c02766:function(){return i(new Date)},__wbg_buffer_cf65c07de34b9a08:function(e){return i(_(e).buffer)},__wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5:function(e,n,t){return i(new Uint8Array(_(e),n>>>0,t>>>0))},__wbg_new_537b7341ce90bb31:function(e){return i(new Uint8Array(_(e)))},__wbg_set_17499e8aa4003ebd:function(e,n,t){_(e).set(_(n),t>>>0)},__wbg_newwithlength_b56c882b57805732:function(e){return i(new Uint8Array(e>>>0))},__wbg_subarray_7526649b91a252a6:function(e,n,t){return i(_(e).subarray(n>>>0,t>>>0))},__wbindgen_object_clone_ref:function(e){return i(_(e))},__wbindgen_throw:function(e,n){throw new Error(y(e,n))},__wbindgen_memory:function(){return i(a.memory)}}},x),R=b.memory,C=b.getaccesskeyfrompassword,L=b.getadditionalmetadata,E=b.setadditionalmetadata,W=b.newdatabase,q=b.__wbindgen_add_to_stack_pointer,B=b.__wbindgen_malloc,F=b.__wbindgen_realloc,I=b.__wbindgen_free,J=b.__wbindgen_exn_store;a=Object.freeze({__proto__:null,__wbindgen_add_to_stack_pointer:q,__wbindgen_exn_store:J,__wbindgen_free:I,__wbindgen_malloc:B,__wbindgen_realloc:F,getaccesskeyfrompassword:C,getadditionalmetadata:L,memory:R,newdatabase:W,setadditionalmetadata:E}),postMessage("ready"),onmessage=e=>{switch(e.data.req){case"newdatabase":console.log("Starting database generation at: "+Date());let n=Date.now();try{postMessage({rtype:"newdatabase",data:JSON.parse(O(e.data.password))})}catch(t){postMessage({fail:!0,rtype:"newdatabase",data:t})}console.log("Finished at: "+Date()+" , total time: "+(Date.now()-n)/1e3+" seconds");break;case"getaccesskey":console.log("Opening database...");try{postMessage({rtype:"getaccesskey",data:S(e.data.database,e.data.password)})}catch(t){postMessage({fail:!0,rtype:"getaccesskey",data:t})}break;case"getadditionalmetadata":console.log("Opening database...");try{postMessage({rtype:"getadditionalmetadata",data:JSON.parse(D(e.data.database,e.data.password))})}catch(t){postMessage({fail:!0,rtype:"getadditionalmetadata",data:t})}break;case"setadditionalmetadata":console.log("Opening database...");try{postMessage({rtype:"setadditionalmetadata",data:j(e.data.database,e.data.password,e.data.metadata)})}catch(t){postMessage({rtype:"setadditionalmetadata",data:t,fail:!0})}}}})()})();
