(function(){"use strict";(async()=>{let a;const f=new Array(128).fill(void 0);function r(e){return f[e]}f.push(void 0,null,!0,!1);let p=f.length;function v(e){const n=r(e);return function(t){t<132||(f[t]=p,p=t)}(e),n}let x=new(typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});x.decode();let h=null;function k(){return h!==null&&h.byteLength!==0||(h=new Uint8Array(a.memory.buffer)),h}function m(e,n){return x.decode(k().subarray(e,e+n))}function i(e){p===f.length&&f.push(f.length+1);const n=p;return p=f[n],f[n]=e,n}let l=0,A=new(typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder)("utf-8");const M=typeof A.encodeInto=="function"?function(e,n){return A.encodeInto(e,n)}:function(e,n){const t=A.encode(e);return n.set(t),{read:e.length,written:t.length}};function g(e,n,t){if(t===void 0){const s=A.encode(e),y=n(s.length);return k().subarray(y,y+s.length).set(s),l=s.length,y}let _=e.length,o=n(_);const d=k();let c=0;for(;c<_;c++){const s=e.charCodeAt(c);if(s>127)break;d[o+c]=s}if(c!==_){c!==0&&(e=e.slice(c)),o=t(o,_,_=c+3*e.length);const s=k().subarray(o+c,o+_);c+=M(e,s).written}return l=c,o}let T=null;function u(){return T!==null&&T.byteLength!==0||(T=new Int32Array(a.memory.buffer)),T}function D(e,n){try{const o=a.__wbindgen_add_to_stack_pointer(-16),d=g(e,a.__wbindgen_malloc,a.__wbindgen_realloc),c=l,s=g(n,a.__wbindgen_malloc,a.__wbindgen_realloc),y=l;a.getaccesskeyfrompassword(o,d,c,s,y);var t=u()[o/4+0],_=u()[o/4+1];return m(t,_)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(t,_)}}function U(e,n){try{const o=a.__wbindgen_add_to_stack_pointer(-16),d=g(e,a.__wbindgen_malloc,a.__wbindgen_realloc),c=l,s=g(n,a.__wbindgen_malloc,a.__wbindgen_realloc),y=l;a.getadditionalmetadata(o,d,c,s,y);var t=u()[o/4+0],_=u()[o/4+1];return m(t,_)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(t,_)}}function O(e,n,t){try{const d=a.__wbindgen_add_to_stack_pointer(-16),c=g(e,a.__wbindgen_malloc,a.__wbindgen_realloc),s=l,y=g(n,a.__wbindgen_malloc,a.__wbindgen_realloc),J=l,N=g(t,a.__wbindgen_malloc,a.__wbindgen_realloc),V=l;a.setadditionalmetadata(d,c,s,y,J,N,V);var _=u()[d/4+0],o=u()[d/4+1];return m(_,o)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(_,o)}}function S(e){try{const _=a.__wbindgen_add_to_stack_pointer(-16),o=g(e,a.__wbindgen_malloc,a.__wbindgen_realloc),d=l;a.newdatabase(_,o,d);var n=u()[_/4+0],t=u()[_/4+1];return m(n,t)}finally{a.__wbindgen_add_to_stack_pointer(16),a.__wbindgen_free(n,t)}}function w(e,n){try{return e.apply(this,n)}catch(t){a.__wbindgen_exn_store(i(t))}}URL=globalThis.URL;const b=await(async(e={},n)=>{let t;if(n.startsWith("data:")){const _=n.replace(/^data:.*?base64,/,"");let o;if(typeof Buffer=="function"&&typeof Buffer.from=="function")o=Buffer.from(_,"base64");else{if(typeof atob!="function")throw new Error("Cannot decode base64-encoded data URL");{const d=atob(_);o=new Uint8Array(d.length);for(let c=0;c<d.length;c++)o[c]=d.charCodeAt(c)}}t=await WebAssembly.instantiate(o,e)}else{const _=await fetch(n),o=_.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&o.startsWith("application/wasm"))t=await WebAssembly.instantiateStreaming(_,e);else{const d=await _.arrayBuffer();t=await WebAssembly.instantiate(d,e)}}return t.instance.exports})({"./wasmlabs_bg.js":{__wbg_new_abda76e883ba8a5f:function(){return i(new Error)},__wbg_stack_658279fe44541cf6:function(e,n){const t=g(r(n).stack,a.__wbindgen_malloc,a.__wbindgen_realloc),_=l;u()[e/4+1]=_,u()[e/4+0]=t},__wbg_error_f851667af71bcfc6:function(e,n){try{console.error(m(e,n))}finally{a.__wbindgen_free(e,n)}},__wbindgen_object_drop_ref:function(e){v(e)},__wbg_randomFillSync_dc1e9a60c158336d:function(){return w(function(e,n){r(e).randomFillSync(v(n))},arguments)},__wbg_getRandomValues_37fa2ca9e4e07fab:function(){return w(function(e,n){r(e).getRandomValues(r(n))},arguments)},__wbg_crypto_c48a774b022d20ac:function(e){return i(r(e).crypto)},__wbindgen_is_object:function(e){const n=r(e);return typeof n=="object"&&n!==null},__wbg_process_298734cf255a885d:function(e){return i(r(e).process)},__wbg_versions_e2e78e134e3e5d01:function(e){return i(r(e).versions)},__wbg_node_1cd7a5d853dbea79:function(e){return i(r(e).node)},__wbindgen_is_string:function(e){return typeof r(e)=="string"},__wbg_require_8f08ceecec0f4fee:function(){return w(function(){return i(module.require)},arguments)},__wbindgen_string_new:function(e,n){return i(m(e,n))},__wbg_msCrypto_bcb970640f50a1e8:function(e){return i(r(e).msCrypto)},__wbindgen_is_function:function(e){return typeof r(e)=="function"},__wbg_newnoargs_2b8b6bd7753c76ba:function(e,n){return i(new Function(m(e,n)))},__wbg_call_95d1ea488d03e4e8:function(){return w(function(e,n){return i(r(e).call(r(n)))},arguments)},__wbg_self_e7c1f827057f6584:function(){return w(function(){return i(self.self)},arguments)},__wbg_window_a09ec664e14b1b81:function(){return w(function(){return i(window.window)},arguments)},__wbg_globalThis_87cbb8506fecf3a9:function(){return w(function(){return i(globalThis.globalThis)},arguments)},__wbg_global_c85a9259e621f3db:function(){return w(function(){return i(global.global)},arguments)},__wbindgen_is_undefined:function(e){return r(e)===void 0},__wbg_call_9495de66fdbe016b:function(){return w(function(e,n,t){return i(r(e).call(r(n),r(t)))},arguments)},__wbg_getTime_7c59072d1651a3cf:function(e){return r(e).getTime()},__wbg_new0_25059e40b1c02766:function(){return i(new Date)},__wbg_buffer_cf65c07de34b9a08:function(e){return i(r(e).buffer)},__wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5:function(e,n,t){return i(new Uint8Array(r(e),n>>>0,t>>>0))},__wbg_new_537b7341ce90bb31:function(e){return i(new Uint8Array(r(e)))},__wbg_set_17499e8aa4003ebd:function(e,n,t){r(e).set(r(n),t>>>0)},__wbg_newwithlength_b56c882b57805732:function(e){return i(new Uint8Array(e>>>0))},__wbg_subarray_7526649b91a252a6:function(e,n,t){return i(r(e).subarray(n>>>0,t>>>0))},__wbindgen_object_clone_ref:function(e){return i(r(e))},__wbindgen_throw:function(e,n){throw new Error(m(e,n))},__wbindgen_memory:function(){return i(a.memory)}}},"/assets/wasmlabs_bg-fa6b70e6.wasm"),j=b.memory,C=b.getaccesskeyfrompassword,E=b.getadditionalmetadata,W=b.setadditionalmetadata,q=b.newdatabase,B=b.__wbindgen_add_to_stack_pointer,L=b.__wbindgen_malloc,R=b.__wbindgen_realloc,F=b.__wbindgen_free,I=b.__wbindgen_exn_store;a=Object.freeze({__proto__:null,__wbindgen_add_to_stack_pointer:B,__wbindgen_exn_store:I,__wbindgen_free:F,__wbindgen_malloc:L,__wbindgen_realloc:R,getaccesskeyfrompassword:C,getadditionalmetadata:E,memory:j,newdatabase:q,setadditionalmetadata:W}),postMessage("ready"),onmessage=e=>{switch(e.data.req){case"newdatabase":console.log("Starting database generation at: "+Date());let n=Date.now();try{postMessage({rtype:"newdatabase",data:JSON.parse(S(e.data.password))})}catch(t){postMessage({fail:!0,rtype:"newdatabase",data:t})}console.log("Finished at: "+Date()+" , total time: "+(Date.now()-n)/1e3+" seconds");break;case"getaccesskey":console.log("Opening database...");try{postMessage({rtype:"getaccesskey",data:D(e.data.database,e.data.password)})}catch(t){postMessage({fail:!0,rtype:"getaccesskey",data:t})}break;case"getadditionalmetadata":console.log("Opening database...");try{postMessage({rtype:"getadditionalmetadata",data:JSON.parse(U(e.data.database,e.data.password))})}catch(t){postMessage({fail:!0,rtype:"getadditionalmetadata",data:t})}break;case"setadditionalmetadata":console.log("Opening database...");try{postMessage({rtype:"setadditionalmetadata",data:O(e.data.database,e.data.password,e.data.metadata)})}catch(t){postMessage({rtype:"setadditionalmetadata",data:t,fail:!0})}}}})()})();
